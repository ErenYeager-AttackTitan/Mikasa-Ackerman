<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>BurnedHub</title>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-900 text-white p-4">

  <h1 class="text-2xl font-bold mb-4">Latest Videos</h1>

  <div id="video-list" class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6"></div>
  <div id="pagination" class="flex justify-center gap-2"></div>

  <script>
    const getPage = () => {
      const params = new URLSearchParams(window.location.search);
      return parseInt(params.get('pg')) || 1;
    };

    const ITEMS_PER_PAGE = 10;

    $.getJSON("https://crew-auth.vercel.app/videos", function(data) {
      data = data.reverse().filter(v => !v.block);
      const totalPages = Math.ceil(data.length / ITEMS_PER_PAGE);
      const page = getPage();

      const start = (page - 1) * ITEMS_PER_PAGE;
      const videosToShow = data.slice(start, start + ITEMS_PER_PAGE);

      videosToShow.forEach(video => {
        const id = video.xvideo ? `?xv=${video.xv}` : video.xhamster ? `?xh=${video.xh}` : "#";
        const card = `
          <a href="watch.html${id}" class="block bg-gray-800 rounded-lg overflow-hidden shadow hover:shadow-lg transition">
            <img src="${video.img}" alt="${video.title}" class="w-full h-40 object-cover">
            <div class="p-2 text-sm font-semibold truncate">${video.title}</div>
          </a>
        `;
        $("#video-list").append(card);
      });

      // Pagination buttons
      for (let i = 1; i <= totalPages; i++) {
        const button = `
          <a href="?pg=${i}" class="px-3 py-1 rounded ${i === page ? 'bg-red-600' : 'bg-gray-700 hover:bg-gray-600'}">
            ${i}
          </a>
        `;
        $("#pagination").append(button);
      }
    });
  </script>

</body>
</html>
